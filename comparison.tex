\chapter{Comparison theorems}

This chapter based on material in the book os Stephanie Alexander, Vitali Kapovitch and the third author \cite{alexander-kapovitch-petrunin2027}.

\section{Model triangles and angles}

Recall that a shortest path between points $x$ and $y$ in a surface $\Sigma$ will be denoted as $[xy]$ or $[xy]_\Sigma$, and
$|x-y|_\Sigma$ denotes the \index{intrinsic distance}\emph{intrinsic distance} from $x$ to $y$ in $\Sigma$.

A \index{geodesic triangle}\emph{geodesic triangle} in a surface $\Sigma$ is a triple of points $x,y,z\in \Sigma$ with choice of minimizing geodesics $[xy]$, $[yz]$ and $[zx]$.
The points $x,y,z$ are called {}\emph{vertexes} of the geodesic triangle,
the minimizing geodesics $[xy]$, $[yz]$ and $[zx]$ are called its {}\emph{sides};
the triangle itself is denoted by $[xyz]$.

A triangle $[\tilde x\tilde y\tilde z]$ in the plane $\RR^2$ is called \index{model triangle}\emph{model triangle} of the triangle $[xyz]$,
briefly $[\tilde x\tilde y\tilde z]=\tilde\triangle xyz$,
\index{$\tilde\triangle$}
if its corresponding sides are equal;
that is,
\[|\tilde x-\tilde y|_{\RR^2}=|x-y|_\Sigma,
\quad
|\tilde y-\tilde z|_{\RR^2}=|y-z|_\Sigma,
\quad
|\tilde z-\tilde x|_{\RR^2}=|z-x|_\Sigma.
\]

A pair of minimizing geodesics $[xy]$ and $[xz]$ starting from one point $x$ is called \index{hinge}\emph{hinge} and denoted as $\hinge xyz$.\index{$\hinge xyz$}
The angle between these geodesics at $x$ is denoted by $\measuredangle\hinge xyz$.
The corresponding angle $\measuredangle\hinge {\tilde x}{\tilde y}{\tilde z}$ in the model triangle $[\tilde x\tilde y\tilde z]=\tilde\triangle xyz$ is denoted by $\angk xyz$.

\section{Formulations}

Part \textit{\ref{SHORT.thm:comp:toponogov}} of the following theorem is called \index{Toponogov comparison theorem}\emph{Toponogov comparison theorem} and sometimes \index{Alexandrov comparison theorem}\emph{Alexandrov comparison theorem};
it is was proved by Paolo Pizzetti \cite{pizzetti} and latter independently by Alexandr Alexandrov \cite{alexandrov}; 
generalizations were obtained by  Victor Toponogov \cite{toponogov1957}, Mikhael Gromov, Yuri Burago and Grigory Perelman \cite{burago-gromov-perelman}.

Part \textit{\ref{SHORT.thm:comp:cat}} is called \index{Cartan--Hadamard theorem}\emph{Cartan--Hadamard theorem};
it was proved by 
Hans von Mangoldt \cite{mangoldt} and generalized by Elie Cartan \cite{cartan}, Jacques Hadamard \cite{hadamard},
Herbert Busemann \cite{busemann},
Willi Rinow \cite{rinow},
Mikhael Gromov \cite[p.~119]{gromov},
Stephanie Alexander and Richard Bishop \cite{alexander-bishop1990}.

Recall that a surface $\Sigma$ is called {}\emph{simply connected} if any closed simple curve in $\Sigma$ bounds a disc.

\begin{thm}{Comparison theorem}\label{thm:comp}
Let $\Sigma$ be a proper smooth regular surface.

\begin{subthm}{thm:comp:toponogov}
If $\Sigma$ has nonnegative Gauss curvature, then 
 \[\measuredangle\hinge {x}{y}{z}\ge\angk xyz\]
for any geodesic triangle $[xyz]$.
\end{subthm}

\begin{subthm}{thm:comp:cat}
If $\Sigma$ is simply connected and has nonpositive Gauss curvature,
 then 
\[\measuredangle\hinge {x}{y}{z}\le\angk xyz\]
for any geodesic triangle $[xyz]$.
\end{subthm}

\end{thm}


Let us make two remarks about the statement.

First, the angle $\measuredangle\hinge {x}{y}{z}$ is a number in the interval $[0,\pi]$.
If the triangle $[xyz]$ bounds a disc $\Delta$ and $\theta$ is the external angle at  $x$ which used in Gauss--Bonnet formula, 
then $\measuredangle\hinge {x}{y}{z}=|\pi-\theta|$.
The corresponding internal angle might be $\measuredangle\hinge {x}{y}{z}$ or $2\cdot\pi-\measuredangle\hinge {x}{y}{z}$ depending on which side lies the disc $\Delta$.

\begin{itemize}
\item Since the angles of any plane triangle sum up to $\pi$,
part \ref{SHORT.thm:comp:toponogov} implies that angles of any triangle in a surface with nonnegative Gauss curvature have sum at least $\pi$.

\item The triangle may not bound a disc%
\footnote{For example equator on the cyclinder is formed by a geodesic triangle that does not bound a disc.}, but  if it does, then by Gauss--Bonnet formula the sum of its {}\emph{internal} angles is at least~$\pi$.
\end{itemize}

These two statements are closely related, but they are not equivalent.
Indeed, if $\alpha$ is the angle in the comparison theorem, then the internal angle might be $\alpha$ or $2\cdot\pi-\alpha$; while Gauss--Bonnet formula gives a lower bound on the sum of internal angles it does not forbid that each of these angles is close to $2\cdot \pi$.
However the latter is impossible by the comparison theorem.

Second, note that without condition that $\Sigma$ is simply connected, the statement \ref{SHORT.thm:comp:cat} does not hold.
For example the equator $z=0$ of the hyperboloid (which is not simply connected)
\[\set{(x,y,z)\in\RR^3}{x^2+y^2-z^2=1}\]
forms a triangle with all angles $\pi$, which contradict the comparison in~\ref{SHORT.thm:comp:cat}.

\begin{thm}{Exercise}\label{ex:diam-angle}
Let $p$ and $q$ be points on a closed convex surface $\Sigma$ that lie on maximal intrinsic distance from each other;
that is, $|p-q|_\Sigma\ge|x-y|_\Sigma$ for any $x,y\in \Sigma$.
Show that 
\[\measuredangle\hinge xpq\ge \tfrac\pi3\]
for any point $x\in \Sigma\backslash\{p,q\}$.
\end{thm}


\section{Local comparisons}

First we prove the following local version of comparison theorem and then use it to prove the global version.

\begin{thm}{Theorem}\label{thm:loc-comp}
The comparison theorem (\ref{thm:comp}) holds in a small neighborhood of any point.

That is, if $\Sigma$ be a smooth regular surface without boundary,
then any point $p\in \Sigma$ admits a neighborhood $U\ni p$ such that 

\begin{subthm}{thm:loc-comp:cbb}
If $\Sigma$ has nonnegative Gauss curvature, then 
\[\measuredangle\hinge {x}{y}{z}\ge\angk xyz\]
for any geodesic triangle $[xyz]$ in $U$.
\end{subthm}

\begin{subthm}{thm:loc-comp:cba}
If $\Sigma$ has nonpositive Gauss curvature, then 
\[\measuredangle\hinge {x}{y}{z}\le\angk xyz\]
for any geodesic triangle $[xyz]$ in $U$.
\end{subthm}
\end{thm}

Note that we can assume that $U$ is simply connected therefore this condition is not necessary to include in part \ref{SHORT.thm:loc-comp:cba}.

\parit{Proof.}
Assume $y=\exp_x\vec v$ and $z=\exp_x\vec w$ for two small vectors $\vec v,\vec w\in\T_x$.
Note that 
\begin{align*}
\measuredangle\hinge 0{\vec v}{\vec w}_{\T_x}&=\measuredangle\hinge xyz_\Sigma,
\\
|\vec v|_{\T_x}&=|x-y|_\Sigma, 
\\
|\vec w|_{\T_x}&=|x-z|_\Sigma.
\end{align*}

\parit{\ref{SHORT.thm:loc-comp:cbb}.}
Consider the line segment $\tilde \gamma$ joining $\vec v$ to $\vec w$ in the tangent plane $\T_x$ and set $\gamma=\exp_x\circ\tilde \gamma$.
By Rauch comparison (\ref{prop:rauch:K>=0}), we have
\[\length\gamma\le \length \tilde \gamma.\]
Since $|\vec v-\vec w|_{\T_x}=\length\tilde \gamma$ and $|y-z|_{\Sigma}\le \length\gamma$, we get 
\[|\vec v-\vec w|_{\T_x}\ge |y-z|_\Sigma.\]
By angle monotonicity (\ref{lem:angle-monotonicity}), we get
\[\angk xzy\le\measuredangle\hinge 0{\vec v}{\vec w}_{\T_x},\]
whence the result.

\parit{\ref{SHORT.thm:loc-comp:cba}.}
Consider a minimizing geodesic $\gamma$ joining $y$ to $z$ in $\Sigma$ and let $\tilde \gamma$ be the corresponding curve joining $\vec v$ to $\vec w$ in $\T_x$; that is,  $\gamma=\exp_x\circ\tilde \gamma$.
By Rauch comparison (\ref{prop:rauch:K=<0}), we have
\[\length\gamma\ge \length \tilde \gamma.\]
Since $|\vec v-\vec w|_{\T_x}\le\length\tilde \gamma$ and $|y-z|_{\Sigma}= \length\gamma$, we get 
\[|\vec v-\vec w|_{\T_x}\ge |y-z|_\Sigma.\]
By angle monotonicity (\ref{lem:angle-monotonicity}), we get
\[\angk xzy\ge\measuredangle\hinge 0{\vec v}{\vec w}_{\T_x}.\]
whence the result.
\qedsf

\section{Alexandrov's lemma}

It this section we prove the following lemma in the plane geometry.

\begin{thm}{Lemma}
\label{lem:alex}
Assume $[pxyz]$ and $[p'x'y'z']$ be two quadraliterals in the plane with equal corresponding sides.
Assume that the sides $[x'y']$ and $[y'z']$ extend each other; that is, $y'$ lies on the line segment $[x'z']$.
Then the following expressions have the same signs:
\begin{enumerate}[(i)]
 \item $|p-y|-|p'-y'|$;
 \item $\measuredangle\hinge xpy-\measuredangle\hinge {x'}{p'}{y'}$;
 \item $\pi-\measuredangle\hinge ypx-\measuredangle\hinge ypz$;
\end{enumerate}
\end{thm}

\begin{figure}[h!]
\vskip-0mm
\centering
\includegraphics{mppics/pic-50}
\vskip-0mm
\end{figure}

\parit{Proof.} 
Take 
a point $\bar z$ on the extension of 
$[xy]$ beyond $y$ so that $\dist{y}{\bar z}{}=\dist{y}{z}{}$ (and therefore $\dist{x}{\bar z}{}=\dist{x'}{z'}{}$). 
 
From angle monotonicity (\ref{lem:angle-monotonicity}), 
the following expressions have the same sign:
\begin{enumerate}[(i)]
\item $|p-y|-|p'-y'|$;
\item $\measuredangle\hinge{x}{y}{p}-\measuredangle\hinge{x'}{y'}{p'}=\measuredangle\hinge{x}{\bar z}{p}-\measuredangle\hinge{x'}{z'}{p'}$;
\item $|p-\bar z|-|p'-z'|$;
\item $\measuredangle\hinge{y}{\bar z}{p}-\measuredangle\hinge{y'}{z'}{p'}$;
\end{enumerate}
The statement follows since
\[\measuredangle\hinge{y'}{z'}{p'}+\measuredangle\hinge{y'}{x'}{p'}=\pi\]
and
\[\measuredangle\hinge{y}{\bar z}{p}+\measuredangle\hinge{y}{x}{p}=\pi.\]
\qedsf

Further we will use the following reformulation of this lemma that is using language of comparison triangles and angles.

\begin{wrapfigure}{r}{25mm}
\vskip-0mm
\centering
\includegraphics{mppics/pic-2305}
\end{wrapfigure}

\begin{thm}{Reformulation}\label{lem:alex-reformulation}
Assume $[pxz]$ be a triangle in a surface $\Sigma$ and 
the point $y$ lies on the side $[xz]$.
Consider its model triangle $[\tilde p\tilde x\tilde z]=\tilde\triangle pxz$ and let $\tilde y$ be the corresponding point on the side $[\tilde x\tilde z]$.
Then the following expressions have the same signs:
\begin{enumerate}[(i)]
 \item $|p-y|_\Sigma-|\tilde p-\tilde y|_{\RR^2}$;
 \item $\angk xpy-\angk {x}{p}{z}$;
 \item $\pi-\angk ypx-\angk ypz$;
\end{enumerate}
\end{thm}

\section{Reformulations}

In this section we formulate conditions equivalent to the conclusion of the comparison theorem (\ref{thm:comp}).

A triangle $[xyz]$ in a surface is called \index{fat triangle}\emph{fat} (or, respectively, \index{thin triangle}\emph{thin})
if for any two points $p$ and $q$ on the sides of the triangle and the corresponding points 
$\tilde p$ and $\tilde q$ on the sides of its model triangle $[\tilde x\tilde y\tilde z]\z=\tilde\triangle xyz$ we have
$|p-q|\ge |\tilde p-\tilde q|$ (or respectively $|p-q|\le |\tilde p-\tilde q|$).


\begin{thm}{Proposition}\label{prop:comp-reformulations}
Let $\Sigma$ be a proper smooth regular surface.
Then the following three conditions are equivalent:

\begin{subthm}{mang>angk}
For any geodesic triangle $[xyz]$ in $\Sigma$ we have
 \[\measuredangle\hinge {x}{y}{z}\ge\angk xyz.\]
\end{subthm}

\begin{subthm}{angk>angk} For any geodesic triangle $[pxz]$ in $\Sigma$ and $y$ on the side $[xz]$ we have
 \[\angk xpy \ge \angk xpz.\]
 
\end{subthm}

\begin{subthm}{fat}
 Any geodesic triangle in $\Sigma$ is fat.
\end{subthm}


\medskip

Similarly, following three conditions are equivalent:

\begin{subthmA}{mang<angk}
For any geodesic triangle $[xyz]$ in $\Sigma$ we have
 \[\measuredangle\hinge {x}{y}{z}\le\angk xyz.\]
\end{subthmA}

\begin{subthmA}{angk<angk} For any geodesic triangle $[pxz]$ in $\Sigma$ and $y$ on the side $[xz]$ we have
 \[\angk xpy \le \angk xpz.\]
\end{subthmA}

\begin{subthmA}{thin}
Any geodesic triangle in $\Sigma$ is thin.
\end{subthmA}

\end{thm}

\parit{Proof.} We will prove the implications \ref{SHORT.mang>angk}$\Rightarrow$\ref{SHORT.angk>angk}$\Rightarrow$\ref{SHORT.fat}$\Rightarrow$\ref{SHORT.mang>angk}.
The implications \ref{SHORT.mang<angk}$\Rightarrow$\ref{SHORT.angk<angk}$\Rightarrow$\ref{SHORT.thin}$\Rightarrow$\ref{SHORT.mang<angk} can be done the same way.

\parit{\ref{SHORT.mang>angk}$\Rightarrow$\ref{SHORT.angk>angk}.}
Note that $\measuredangle\hinge ypx+\measuredangle\hinge ypz=\pi$.
By \textit{\ref{SHORT.mang>angk}}, 
\[\angk ypx+\angk ypz\le \pi.\]
It reamains to apply Alexandrov's lemma (\ref{lem:alex-reformulation}).


\parit{\ref{SHORT.angk>angk}$\Rightarrow$\ref{SHORT.fat}.}
Applying \textit{\ref{SHORT.mang>angk}} twice, first for $y\in [xz]$ and then for $w\in [px]$, we get that
\[\angk xwy \ge \angk xpy \ge \angk xpz\]
and therefore
\[|w-y|_\Sigma\ge |\tilde w-\tilde y|_{\RR^2},\]
where $\tilde w$ and $\tilde y$ are the points corresponding to $w$ and $y$ points on the sides of the model triangle. Hence the implication follows.

\parit{\ref{SHORT.fat}$\Rightarrow$\ref{SHORT.mang>angk}.}
Since the triangle is fat, we have 
\[\angk xwy \ge \angk xpz\]
for any $w\in \left]xp\right]$ and $y\in \left]xz\right]$.
Note that $\angk xwy\to \measuredangle\hinge xpz$ as $w,y\to x$, whence the implication follows.
\qeds

In the following exercises you can apply the globalization theorem.

\begin{thm}{Exercise}\label{ex:sum=<2pi}
Let $\Sigma$ be a closed (or open) regular surface and with nonnegative Gauss curvature.
Show that 
\[\angk pxy+\angk pyz+\angk pzx\le2\cdot \pi.\]
for any four distinct points $p,x,y,z$ on $\Sigma$.
\end{thm}

\begin{thm}{Exercise}\label{ex:geod-convexity}
Let $\Sigma$ be an open smooth regular surface
and $\gamma$ be a unit-speed geodesic in $\Sigma$ and $p\in\Sigma$.

Consider the function
\[h(t)=|p-\gamma(t)|_\Sigma^2-t^2.\]

\begin{enumerate}[(a)]
\item Show that if the Gauss curvature of $\Sigma$ is nonnegative, then the function $h$ is concave.
\item Show that if $\Sigma$ is simply connected and the Gauss curvature of $\Sigma$ is nonpositive, then the function $h$ is convex.
\end{enumerate}
\end{thm}


\begin{thm}{Exercise}\label{ex:midpoints}
Let $x'$ and $y'$ be the midpoints of minimizing geodesics $[px]$ and $[py]$ in an open smooth regular surface $\Sigma$.
\begin{enumerate}[(a)]
 \item Show that if the Gauss curvature of $\Sigma$ is nonnegative, then 
 \[2\cdot |x'-y'|_\Sigma\ge |x-y|_\Sigma.\]
 \item Show that if $\Sigma$ is simply connected and has nonpositive Gauss curvature, then 
 \[2\cdot |x'-y'|_\Sigma\le |x-y|_\Sigma.\]
\end{enumerate}

\end{thm}


\section{Nonnegative curvature}

We will prove \ref{thm:comp:toponogov}, first assuming that $\Sigma$ is compact.
The general case requires only minor modifications; they are indicated in Exercise \ref{ex:open-comparison} at the end of the section.
The proof is taken from \cite{alexander-kapovitch-petrunin2027} and it is very close to the proof given by Urs Lang and Viktor Schroeder \cite{lang-schroeder}.

\parit{Proof of \ref{thm:comp:toponogov} in compact case.}\label{proof(thm:comp:toponogov)}
Assume $\Sigma$ is compact. 
From the local theorem (\ref{thm:loc-comp}), we get that there is $\eps>0$ such that the inequality 
\[\measuredangle\hinge {x}{p}{q}\ge\angk xpq.\]
holds for any hinge $\hinge {x}{p}{q}$ such that $|x-p|+|x-q|<\eps$.
The following lemma states that in this case the same holds for any hinge $\hinge {x}{p}{q}$ such that $|x-p|+|x-q|<\tfrac32\cdot\eps$.
Applying the key lemma (\ref{key-lem:globalization}) few times we will get that the comparison holds for arbitrary hinge, which will prove \mbox{\ref{thm:comp:toponogov}}.
\qeds

\begin{thm}{Key lemma}\label{key-lem:globalization}  
Let $\Sigma$ be an open smooth regular surface.
Assume that the comparison
\[\measuredangle\hinge x y z
\ge\angk x y z\eqlbl{eq:key-lem:globalization}\]
holds for any hinge $\hinge x y z$ with 
$\dist{x}{y}{}+\dist{x}{z}{}
<
\frac{2}{3}\cdot\ell$.
Then the comparison \ref{eq:key-lem:globalization}
holds for any hinge $\hinge x y z$ with $\dist{x}{y}{}+\dist{x}{z}{}<\ell$.
\end{thm}

\begin{wrapfigure}{r}{35mm}
\centering
\includegraphics{mppics/pic-2308}
\bigskip
\includegraphics{mppics/pic-2310}
\end{wrapfigure}

\parit{Proof.} 
Given a hinge $\hinge x p q$ consider a triangle in the plane
with angle $\measuredangle\hinge x p q$ and two adjacent sides $|x-p|$ and $|x-q|$.
Let us denote by $\side \hinge x p q$ the third side of this triangle; let us call it \index{model side}\emph{model side} of the hinge.

Note that the inequalities 
\[\measuredangle\hinge x p q\ge \angk x p q\quad\text{and}\quad\side \hinge x p q
\ge\dist{p}{q}{}\]
are equivalent.
So it is sufficient to prove that
\[\side \hinge x p q
\ge\dist{p}{q}{}.\eqlbl{eq:thm:=def-loc*}\] 
for any hinge $\hinge x p q$ with $\dist{x}{p}{}+\dist{x}{q}{}<\ell$.


Given a hinge $\hinge x p q$ such that 
\[\tfrac{2}{3}\cdot\ell \le\dist{p}{x}{}\z+\dist{x}{q}{}< \ell,\]
let us construct a new smaller hinge $\hinge{x'}p q$; that is,
\[
\dist{p}{x}{}+\dist{x}{q}{}\ge\dist{p}{x'}{}+\dist{x'}{q}{}
\eqlbl{eq:thm:=def-loc-fourstar}\]
and such that 
\[\side \hinge x p q
\ge\side \hinge{x'}p q.
\eqlbl{eq:thm:=def-loc-fivestar}\]

%\parit{Construction of $\hinge{x'}p q$.}
Assume $\dist{x}{q}{}\ge\dist{x}{p}{}$, otherwise switch the roles of $p$ and $q$ in the following construction.
Take $x'\in [x q]$ such that 
\[\dist{p}{x}{}+3\cdot\dist{x}{x'}{}
=\tfrac{2}{3}\cdot\ell \eqlbl{3|xx'|}\]
Choose a geodesic $[x' p]$ and consider the  hinge $\hinge{x'}p q$ fromed by $[x'p]$ and $[x' q]\subset [x q]$. 
Then \ref{eq:thm:=def-loc-fourstar} follows since the length of $[x'p]$ can not exceed the total length of $[x'x]$ and $[x'p]$.

Further, note that 
$\dist{p}{x}{}\z+\dist{x}{x'}{},\dist{p}{x'}{}\z+\dist{x'}{x}{}<\tfrac{2}{3}\cdot\ell $.
In particular, 
\[\measuredangle\hinge x p{x'}
\ge\angk x p{x'}
\ \ \text{and}\ \ 
\measuredangle\hinge {x'}p x
\ge\angk {x'}p x.
\eqlbl{eq:thm:=def-loc-threestar}\]


Consider the model triangle
$\trig{\tilde x}{\tilde x'}{\tilde p}=\modtrig xx'p$.
Take $\tilde  q$ on the extension of $[\tilde  x\tilde  x']$ beyond $x'$ such that $\dist{\tilde x}{\tilde q}{}=\dist{x}{q}{}$ (and therefore $\dist{\tilde x'}{\tilde q}{}=\dist{x'}{q}{}$).
From \ref{eq:thm:=def-loc-threestar},
\[\measuredangle\hinge x p q
=\measuredangle\hinge  x p{x'}\ge\angk x p{x'}\ \ \Rightarrow\ \ 
\side \hinge x q p\ge\dist{\tilde p}{\tilde q}{}.\]
Since $\measuredangle\hinge{x'}p x+\measuredangle\hinge{x'}p q= \pi$,
\ref{eq:thm:=def-loc-threestar} implies
\[
\pi
-\angk{x'}p x
\ge
\pi-\measuredangle\hinge{x'}p x
\ge
\measuredangle\hinge{x'}p q.
\]
Therefore
$\dist{\tilde p}{\tilde q}{}\ge\side \hinge{x'}q p$ and \ref{eq:thm:=def-loc-fivestar} follows.

\begin{figure}[h!]
\centering
\includegraphics{mppics/pic-2315}
\end{figure}

Set $x_0=x$.
Let us apply inductively the above construction to get a sequence of hinges  $\hinge{x_n}p q$ with $x_{n+1}=x_n'$.
By \ref{eq:thm:=def-loc-fivestar} and triangle inequality, both sequences
\[s_n=\side \hinge{x_n}pq\quad\text{and}\quad r_n=\dist{p}{x_n}{}+\dist{x_n}{q}{}\]
are nonincreasing.

The sequence might terminate at some $n$ only if $r_n< \tfrac{2}{3}\cdot\ell $.
In this case, by the assumptions of the lemma, 
\[s_n=\side \hinge{x_n}p q\ge\dist{p}{q}{}.\]
Since sequence $s_n$ is nonincreasing;
\[s_0=\side \hinge{x}p q\ge\dist{p}{q}{},\]
whence inequality \ref{eq:thm:=def-loc*} follows.

If the sequence does not terminate, then $r_n\ge\tfrac{2}{3}\cdot\ell$ for all $n$.
Since $(r_n)$ is nonincreasing, $r_n\to r\ge |p-q|_\Sigma$ as $n\to\infty$.

Let us show that $\measuredangle\hinge{x_n}p q\to \pi$ as $n\to\infty$.

Indeed assume $\measuredangle\hinge{x_n}p q\le \pi-\eps$ for some $\eps>0$.
Without loss of generality we can assume that $x_{n+1}\in [x_nq]$;
otherwise switch $p$ and $q$ further.
Note that $|x_n-x_{n+1}|,|p-x_n|>\tfrac\ell{100}$.
Therefore by comparison 
\[|p-x_{n+1}|<\side\hinge{x_n}p{x_{n+1}}<|p-x_n|+|x_n-x_{n+1}|-\delta\]
for some fixed $\delta=\delta(\eps)>0$.
Therefore $r_n-r_{n+1}>\delta$.
The latter can not hold for large $n$, otherwise the sequence $r_n$ would not converge.

It follows that for any $\eps>0$ we have that $\measuredangle\hinge{x_n}p q> \pi-\eps$ for all large $n$;
that is, $\measuredangle\hinge{x_n}p q\to \pi$ as $n\to\infty$.

Since $\measuredangle\hinge{x_n}p q\to \pi$, we have 
$s_n-r_n\to 0$ as $n\to\infty$;
that is, $s_n\to r$.

Since the sequence $(s_n)$ is nonincreasing and $r\ge |p-q|$, we get
\[s_n\ge |p-q|\]
for any $n$.
In particular
\[\side\hinge spq=s_0\ge |p-q|,\] so we obtain \ref{eq:thm:=def-loc*}.
\qeds

\begin{thm}{Exercise}\label{ex:open-comparison}
Let $\Sigma$ be an open surface with nonnegative Gauss curvature.
Given $p\in\Sigma$, denote by $R_p$ 
(the \index{comparison radius}\emph{comparison radius} at $p$) 
the maximal value (possibly $\infty$) such that the comparison 
\[\measuredangle\hinge x p y
\ge\angk x p y\]
holds for any hinge $\hinge x p y$ with $\dist{p}{x}{}+\dist{x}{y}{}<R_p$.

\begin{subthm}{ex:open-comparison:positive}
Show that for any compact subset $K\subset \Sigma$, there is $\eps>0$ such that $R_p>\eps$ for any $p\in K$.
\end{subthm}

\begin{subthm}{ex:open-comparison:almost-min}
Use part \ref{SHORT.ex:open-comparison:positive} to show that 
there is a point $p\in\Sigma$ such that 
\[R_q>(1-\tfrac1{100})\cdot R_p,\]
for any $q\in B(p,100\cdot R_p)_\Sigma$.
\end{subthm}

\begin{subthm}{ex:open-comparison:proof}
Use \ref{SHORT.ex:open-comparison:almost-min} to extend the proof on page \pageref{proof(thm:comp:toponogov)} to open surfaces. 
(Show that $R_p=\infty$ for any $p\in\Sigma$.) 
\end{subthm}


\end{thm}


\begin{wrapfigure}{r}{30 mm}
\vskip-0mm
\centering
\includegraphics{mppics/pic-471}
\end{wrapfigure}

\begin{thm}{Advanced exercise}\label{ex:convex-polyhon+self-intersections}
Let $\Sigma$ be a closed smooth regular surface with nonnegative Gauss curvature.
The following sketch that shows that a closed geodesic $\gamma$ on $\Sigma$ cannot have self-intersections as shown on the diagram;
in other words, $\gamma$ cannot cut $\Sigma$ into 3 monogons, one quadrangle, and one pentagon. 

Make a complete proof from it.

Arguing by contradiction, suppose that such geodesic exists;
assume that arcs and angles are labeled as on the left diagram.

\begin{figure}[h!]
\begin{minipage}{.38\textwidth}
\centering
\includegraphics{mppics/pic-472}
\end{minipage}\hfill
\begin{minipage}{.58\textwidth}
\centering
\includegraphics{mppics/pic-473}
\end{minipage}
\end{figure}

\begin{subthm}{ex:convex-polyhon+self-intersections:angles}
Apply Gauss--Bonnet formula to show that
\[2\cdot\alpha<\beta+\gamma\]
and 
\[2\cdot\beta+2\cdot \gamma<\pi+\alpha.\]
Conclude that $\alpha <\tfrac \pi 3$.
\end{subthm}

\begin{subthm}{ex:convex-polyhon}
Consider the part of the geodesic $\gamma$ without the arc~$a$.
It cuts from $\Sigma$ a pentagon with sides and angles as shown on the diagram. 
Show that there is a plane pentagon with convex sides of the same length and angles at most as big.
\end{subthm}

\begin{subthm}{ex:self-intersections-hard}
Arrive to a contradiction using \ref{SHORT.ex:convex-polyhon+self-intersections:angles} and \ref{SHORT.ex:convex-polyhon}. 
\end{subthm}

\end{thm}



\begin{thm}{Advanced exercise}\label{ex:dist-to-bry}
Suppose that a closed geodesic $\delta$ bounds a disc $\Delta$ in a closed convex surface $\Sigma$.
Given a point $p\in\Delta$, denote by $f(p)$ the intrinsic distance from $p$ to $\delta$;
that is,
\[f(p)=\inf\set{|p-x|_\Sigma}{x\in\delta}.\]
Show that the function $f$ is concave;
that is, for any geodesic $\gamma$ in $\Delta$ the function $t\mapsto f\circ\gamma(t)$ is concave.
\end{thm}


\section{Inheritance lemma}

The following lemma will play key role in the proof of \ref{thm:comp:cat}.

\begin{wrapfigure}{r}{25mm}
\vskip-0mm
\centering
\includegraphics{mppics/pic-2320}
\end{wrapfigure}

\begin{thm}{Inheritance Lemma}
\label{lem:inherit-angle} 
Assume that a triangle $\trig p x y$ in a surface $\Sigma$ \index{decomposed triangle}\emph{decomposes} 
into two triangles $\trig p x z$ and $\trig p y z$;
that is, $\trig p x z$ and $\trig p y z$ have common side $[p z]$, and the sides $[x z]$ and $[z y]$ together form the side $[x y]$ of $\trig p x y$.

If  both triangles $\trig p x z$ and $\trig p y z$ are thin, 
then so is  $\trig p x y$.
\end{thm} 

We shall need the following lemma in plane geometry.


\begin{thm}{Lemma}\label{lem:quadrangle}
Let $\solidtriangle{\tilde p}{\tilde x}{\tilde y}$ be a solid plane triangle; that is, $\solidtriangle{\tilde p}{\tilde x}{\tilde y}\z=\Conv\{{\tilde p},{\tilde x},{\tilde y}\}$.
Given  $\tilde z\in[\tilde x\tilde y]$,
consider  points $\dot p, \dot x, \dot z, \dot y$ in the plane such that 
\begin{align*}
\dist{\dot p}{\dot x}{}&=\dist{\tilde p}{\tilde x}{},
&
\dist{\dot p}{\dot y}{}&=\dist{\tilde p}{\tilde y}{},
&
\dist{\dot p}{\dot z}{}&\le \dist{\tilde p}{\tilde z}{},
\\
\dist{\dot x}{\dot z}{}&=\dist{\tilde x}{\tilde z}{},
&
\dist{\dot y}{\dot z}{}&=\dist{\tilde y}{\tilde z}{},
\end{align*}
where points $\dot x$ and $\dot y$ lie on either side of $[\dot p\dot z]$.
Then there is a short map 
\[F\:\solidtriangle{\tilde p}{\tilde x}{\tilde y}\to \solidtriangle{\dot p}{\dot x}{\dot z}\cup \solidtriangle{\dot p} {\dot y} {\dot z}\]
that maps $\tilde p$, $\tilde x$, $\tilde y$ and $\tilde z$ to $\dot p$, $\dot x$, $\dot y$ and $\dot z$ respectively.
\end{thm}

\begin{wrapfigure}{r}{45 mm}
\vskip-4mm
\centering
\includegraphics{mppics/pic-2325}
\end{wrapfigure}

\parit{Proof.} 
Note that 
\begin{align*}
|\dot x-\dot y|&\le |\dot x-\dot z|+|\dot z-\dot y|=
\\
&=|\tilde  x-\tilde  z|+|\tilde  z-\tilde  y|
\\
&=|\tilde  x-\tilde  y|.
\end{align*}
Applying angle monotonicity (\ref{lem:angle-monotonicity}), we get that
\[\measuredangle\hinge{\dot p}{\dot x}{\dot y}\le \measuredangle\hinge{\tilde  p}{\tilde  x}{\tilde  y}.\]
It follows that there are nonoverlapping triangles 
$\trig{\tilde p}{\tilde x}{\tilde w}\cong\trig {\dot p}{\dot x}{\dot z}$ 
and 
$\trig{\tilde p}{\tilde y}{\tilde v}\cong\trig {\dot p}{\dot y}{\dot z}$
 inside of the triangle $\trig{\tilde p}{\tilde x}{\tilde y}$.


Connect points in each pair
$(\tilde z,\tilde v)$, 
$(\tilde v,\tilde w)$ 
and $(\tilde w,\tilde z)$ 
with arcs of circles centered at 
$\tilde y$, $\tilde p$, and $\tilde x$ respectively. 
Define $F$ as follows.
\begin{itemize}
\item Map  $\solidtriangle{\tilde p}{\tilde x}{\tilde w}$ isometrically onto  $\solidtriangle {\dot p}{\dot x}{\dot y}$;
similarly map $\solidtriangle{\tilde p}{\tilde y}{\tilde v}$ onto $\solidtriangle {\dot p}{\dot y}{\dot z}$.
\item If a point $w$ lies in one of the three circular sectors, say at distance $r$ from center of the circle, let $F(w)$ be the point on the corresponding segment 
$[\dot p \dot z]$, 
$[\dot x \dot z]$ 
or $[\dot y \dot z]$ whose distance from the lefthand endpoint of the segment is $r$.
\item Finally, if $w$ lies in the remaining curvilinear triangle $\tilde z \tilde v \tilde w$, 
set $F(w) =\dot z$. 
\end{itemize}
By construction, $F$ satisfies the remaining conditions of the lemma. 
\qeds


\parit{Proof of the inheritance lemma (\ref{lem:inherit-angle}).}
Construct model triangles $\trig{\dot p}{\dot x}{\dot z}\z=\modtrig(p x z)$ 
and $\trig {\dot p} {\dot y} {\dot z}=\modtrig(p y z)$ so that $\dot x$ and $\dot y$ lie on opposite sides of $[\dot p\dot z]$.

\begin{wrapfigure}{r}{30 mm}
\vskip-0mm
\centering
\includegraphics{mppics/pic-2330}
\end{wrapfigure}

Suppose
\[\angk{z}{p}{x}+\angk{z}{p}{y}
<
\pi.\]
Then for some point $\dot w\in[\dot p\dot z]$, we have \[\dist{\dot x}{\dot w}{}+\dist{\dot w}{\dot y}{}
<
\dist{\dot x}{\dot z}{}+\dist{\dot z}{\dot y}{}=\dist{x}{y}{}.\]
Let $w\in[p z]$ correspond to $\dot w$; that is, $\dist{z}{w}{}=\dist{\dot z}{\dot w}{}$. 
Since $\trig p x z$ and $\trig p y z$ are thin, we have 
\[\dist{x}{w}{}+\dist{w}{y}{}<\dist{x}{y}{},\]
contradicting the triangle inequality. 

Thus 
\[\angk{z}{p}{x}+\angk{z}{p}{y}
\ge
\pi.\]
By Alexandrov's lemma (\ref{lem:alex-reformulation}), this is equivalent to 
\[\angk x p z\le\angk x p y.
\eqlbl{eq:for|pz|}\]

Let $\trig{\tilde  p}{\tilde  x}{\tilde  y}=\modtrig (p x y)$ 
and $\tilde  z\in[\tilde  x\tilde  y]$ correspond to $z$; that is, $\dist{x}{z}{}=\dist{\tilde  x}{\tilde  z}{}$.
Inequality~\ref{eq:for|pz|} is equivalent to $\dist{ p}{ z}{}\le \dist{\tilde  p}{\tilde  z}{}$.
Hence  Lemma~\ref{lem:quadrangle} applies;
let $F\:\solidtriangle{\tilde  p}{\tilde  x}{\tilde  y}\to\solidtriangle {\dot p}{\dot x}{\dot z}\cup \solidtriangle {\dot p} {\dot y} {\dot z}$ be the provided short map.

Fix $v,w$ on the sides of $\trig p x y$;
let $\tilde v,\tilde w$ be the corresponding points on the sides of the model triangle $\trig {\tilde p}{\tilde x}{\tilde y}=\modtrig p x y$
and $\dot v,\dot w$ be the corresponding points on the sides of the model triangles $\trig {\dot p} {\dot x}{\dot z}=\modtrig p x z$ and $\trig {\dot p} {\dot y}{\dot z}=\modtrig p y z$.
Denote by $\ell$ the length of shortest curve from $\dot v$ to $\dot w$ in $\solidtriangle {\dot p}{\dot x}{\dot z}\cup \solidtriangle {\dot p} {\dot y} {\dot z}$.
Since $F$ is short, $|\tilde v-\tilde w|_{\RR^2}\ge \ell$.
Since both triangles $\trig p x z$ and $\trig p y z$ are thin, $\ell\ge|v-w|_{\Sigma}$.

It follows that $|\tilde v-\tilde w|_{\RR^2}\ge |v-w|_{\Sigma}$ for any $v$ and $w$;
that is, the triangle $\trig p x y$ is thin.
\qeds

\section{Nonpositive curvature}

Assume $\Sigma$ is an open smooth regular surface with nonpositive curvature.
As it follow from Exercise \ref{ex:unique-geod} any two points $x$ and $y$ in $\Sigma$ are joined by unique geodesic $[xy]$.

\begin{figure}[h!]
\vskip0mm
\centering
\includegraphics{mppics/pic-2335}
\end{figure}

Note that the geodesic $[xy]$ depends continuously on its endpoints $x$ and $y$. 
That is, if $\gamma_{[xy]}\:[0,1]\to \Sigma$ is the constant speed parametrization of $[xy]$ from $x$ to $y$,
then the map $(x,y,t)\mapsto \gamma_{[xy]}(t)$ is continuous in three arguments.
Indeed, assume contrary, that is, $x_n\to x$, $y_n\to y$ and $t_n\to t$ as $n\to \infty$ and 
$\gamma_{[x_ny_n]}(t_n)$ does not converge to $\gamma_{[xy]}(t)$. 
Then we can pass to a subsequence such that $\gamma_{[x_ny_n]}(t_n)$ converges to a point distinct from $w\ne \gamma_{[xy]}(t)$.
Note that $w\notin [xy]$. 
Therefore there will be two distinct geodesics from $x$ to $y$;
one is $[xy]$ and the other is the limit of $[x_ny_n]$ which passes thru $w$.

\parit{Proof of \ref{thm:comp:cat}.}
Fix a triangle $[p x y]$; 
by Proposition~\ref{prop:comp-reformulations}, it is sufficient to show that the triangle $\trig p x y$ is thin.   

Fix large integer $N$ and 
divide $[xy]$ by points $x=x^{0,N},\dots,x^{N,N}=y$ into $N$ equal parts.
Further divide each geodesic $[p\,x^{i,N}]$ into $N$ equal parts by points $p=x^{i,0},\dots,x^{i,N}$.
Since the geodesic depends continuously on its end points, we can assume that each triangle 
 $\trig{x^{i,j}}{\,x^{i,j+1}}{\,x^{i+1,j+1}}$ and $\trig{x^{i,j}}{\,x^{i+1,j}}{\,x^{i+1,j+1}}$ is small;
 in particular, by local comparison (\ref{thm:loc-comp}), each of these triangles is thin. 

Now we show that the thin property propagates to $\trig p x y$ by repeated application of the inheritance lemma (\ref{lem:inherit-angle}):
\begin{itemize}
\item 
First, for fixed $i$, 
sequentially applying the lemma shows  that the triangles 
$\trig{x}{\,x^{i,1}}{\,x^{i+1,2}}$, 
$\trig{x}{\,x^{i,2}}{\,x^{i+1,2}}$, 
$\trig{x}{\,x^{i,2}}{\,x^{i+1,3}}$,
and so on are thin. 
\end{itemize}
In particular, for each $i$, the long triangle $\trig{x}{\,x^{i,N}}{\,x^{i+1,N}}$ is thin.
\begin{itemize} 
\item 
Applying the lemma again shows that the  triangles $\trig{x}{\,x^{0,N}}{\,x^{2,N}}$, $\trig{x}{\,x^{0,N}}{\,x^{3,N}}$, and so on are thin. 
\end{itemize}
In particular, $\trig p x y=\trig{p}{\,x^{0,N}}{\,x^{N,N}}$ is thin.
\qeds


\begin{thm}{Exercise}\label{ex:convex-dist}
Assume $\gamma_1$ and $\gamma_2$ are two geodesics in an open smooth regular simply connected surface $\Sigma$ with nonpositive Gauss curvature.
Show that the function
\[h(t)=|\gamma_1(t)-\gamma_2(t)|_\Sigma\]
is convex.
\end{thm}

\begin{thm}{Exercise}\label{ex:convex-dist+}
Suppose $\delta$ is a geodesics in an open smooth regular simply connected surface $\Sigma$ with nonpositive Gauss curvature.
Given a point $p\in\Delta$, denote by $f(p)$ the intrinsic distance from $p$ to $\delta$;
that is,
\[f(p)=\inf\set{|p-x|_\Sigma}{x\in\delta}.\]
Use \ref{ex:convex-dist}to show that the function $f$ is convex;
that is, for any geodesic $\gamma$ in $\Sigma$ the function $t\mapsto f\circ\gamma(t)$ is concave.
\end{thm}


%???+Splitting theorem???
